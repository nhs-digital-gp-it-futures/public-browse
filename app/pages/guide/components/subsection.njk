{% from 'components/button/macro.njk' import button %}

{% macro subsection(params) %}
  {% if params.subSection.title %}
    <h4 class="nhsuk-u-margin-top-4 nhsuk-u-margin-bottom-0" data-test-id="subsection-title-{{ params.subSection.id }}">{{ params.subSection.title }}</h4>
  {% endif %}

  {% if params.subSection.description %}
    <div data-test-id="subsection-{{ params.subSection.id }}">
      {% for descriptionText in params.subSection.description %}
          {% if descriptionText.href %}
            <div class="nhsuk-u-margin-top-4" data-test-id="guide-section-description-with-link">
              <span>{{ descriptionText.startText }}</span>
                <a data-test-id="guide-link" href="{{ descriptionText.href }}">{{ descriptionText.linkText }}</a>
              <span>{{ descriptionText.endText }}</span>
            </div>
          {% else %}
            <div class="nhsuk-u-margin-top-4">{{ descriptionText }}</div>
          {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  {% if params.subSection.bulletlist %}
    <ul class="nhsuk-u-margin-top-2" data-test-id="subsection-bulletlist">
      {% for text in params.subSection.bulletlist %}
        <li class="nhsuk-u-font-size-19">{{ text }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if params.subSection.button %}
    <div class="nhsuk-u-margin-top-4" data-test-id="subsection-button">
      {{ button({
        "text": params.subSection.button.text,
        "classes": "nhsuk-button--secondary nhsuk-u-margin-bottom-0",
        "href": params.blobstoreHost + params.subSection.button.href
      }) }}
    </div>
  {% endif %}
{% endmacro %}
